# CRD Documentation - Redirect to Authoritative Sources

**Status**: All design documents in this directory have been **DEPRECATED** and moved to [`archive/`](archive/)

---

## ğŸ¯ **FOR CURRENT V1 CRD INFORMATION, SEE:**

### **1. Implementation (Source of Truth)** â­ PRIMARY

**Go Type Definitions**:
```
api/
â”œâ”€â”€ aianalysis/v1alpha1/aianalysis_types.go
â”œâ”€â”€ ~~kubernetesexecution/v1alpha1/kubernetesexecution_types.go~~ (DEPRECATED - ADR-025)
â”œâ”€â”€ remediation/v1alpha1/remediationrequest_types.go
â”œâ”€â”€ remediationorchestrator/v1alpha1/remediationorchestrator_types.go
â”œâ”€â”€ remediationprocessing/v1alpha1/remediationprocessing_types.go
â””â”€â”€ workflowexecution/v1alpha1/workflowexecution_types.go
```

**Why Primary**: These are the actual CRD type definitions that Kubebuilder uses to generate manifests.

---

### **2. Generated CRD Manifests**

**Kubernetes YAML Manifests**:
```
config/crd/bases/
â”œâ”€â”€ aianalysis.kubernaut.io_aianalyses.yaml
â”œâ”€â”€ ~~kubernetesexecution.kubernaut.io_kubernetesexecutions.yaml~~ (DEPRECATED - ADR-025)
â”œâ”€â”€ remediation.kubernaut.io_remediationrequests.yaml
â”œâ”€â”€ remediationorchestrator.kubernaut.io_remediationorchestrators.yaml
â”œâ”€â”€ signalprocessing.kubernaut.io_remediationprocessings.yaml
â””â”€â”€ workflowexecution.kubernaut.io_workflowexecutions.yaml
```

**Generated By**: `make manifests` (Kubebuilder controller-gen)

---

### **3. Schema Documentation**

**Authoritative Schema Documentation**:
- **[`docs/architecture/CRD_SCHEMAS.md`](../../architecture/CRD_SCHEMAS.md)** - Complete OpenAPI v3 schemas for all 6 CRDs

**Purpose**: Human-readable documentation of CRD schemas with business context

---

### **4. Service Specifications (~10,000 lines total)**

**Complete Service Documentation**:
```
docs/services/crd-controllers/
â”œâ”€â”€ 01-signalprocessing/     (~2,000 lines)
â”‚   â”œâ”€â”€ README.md                 - Service index
â”‚   â”œâ”€â”€ crd-schema.md             - CRD expectations
â”‚   â”œâ”€â”€ controller-implementation.md
â”‚   â””â”€â”€ [12 more documents]
â”‚
â”œâ”€â”€ 02-aianalysis/               (~2,500 lines)
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ crd-schema.md
â”‚   â”œâ”€â”€ prompt-engineering-dependencies.md
â”‚   â””â”€â”€ [15 more documents]
â”‚
â”œâ”€â”€ 03-workflowexecution/        (~2,000 lines)
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ crd-schema.md
â”‚   â”œâ”€â”€ workflow-dependency-resolution.md
â”‚   â””â”€â”€ [12 more documents]
â”‚
â”œâ”€â”€ 04-kubernetesexecutor/       (~2,000 lines) (DEPRECATED - ADR-025)
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ crd-schema.md
â”‚   â”œâ”€â”€ step-validation-pattern.md
â”‚   â””â”€â”€ [12 more documents]
â”‚
â””â”€â”€ 05-remediationorchestrator/  (~2,806 lines)
    â”œâ”€â”€ README.md
    â”œâ”€â”€ crd-schema.md
    â”œâ”€â”€ data-handling-architecture.md
    â””â”€â”€ [12 more documents]
```

**Purpose**: Complete service specifications, controller logic, integration patterns, testing strategies

---

## ğŸš¨ **Why Were Design Documents Deprecated?**

**ALL 5 design documents in `archive/` are severely outdated:**

| Document | Accuracy | Critical Issues |
|----------|----------|-----------------|
| 01_REMEDIATION_REQUEST_CRD.md | ~40% | Wrong CRD name, API group, 18 missing fields |
| 02_REMEDIATION_PROCESSING_CRD.md | ~30% | Missing 18 Phase 1 self-contained fields |
| 03_AI_ANALYSIS_CRD.md | ~50% | Missing LLM-driven patterns, dependency specification |
| 04_WORKFLOW_EXECUTION_CRD.md | ~40% | Missing validation chain, dependency analysis |
| 05_KUBERNETES_EXECUTION_CRD.md | ~40% | Missing step-level validation pattern. **DEPRECATED (ADR-025)** - CRD eliminated |

**Common Issues**:
- â›” **Wrong CRD names** (e.g., `alertremediations` vs `remediationrequests`)
- â›” **Wrong API groups** (e.g., `kubernaut.io` vs `remediation.kubernaut.io`)
- ğŸŸ¡ **Wrong API version** (`v1` vs `v1alpha1`)
- â›” **Deprecated "Alert" terminology** throughout
- ğŸ”´ **Missing V1 architectural patterns** (self-containment, LLM-driven, validation chain)

**See Triage Report**: [`docs/analysis/CRD_DESIGN_DOCUMENTS_COMPREHENSIVE_TRIAGE.md`](../../analysis/CRD_DESIGN_DOCUMENTS_COMPREHENSIVE_TRIAGE.md)

---

## ğŸ“š **CRD Documentation Hierarchy**

**When looking for CRD information, use this order:**

1. **Implementation** â†’ `api/*/v1alpha1/*_types.go` (source of truth)
2. **Manifests** â†’ `config/crd/bases/*.yaml` (what actually deploys)
3. **Schema Docs** â†’ `docs/architecture/CRD_SCHEMAS.md` (readable schemas)
4. **Service Specs** â†’ `docs/services/crd-controllers/*/` (controller implementation details)
5. **Architecture** â†’ `docs/architecture/` (high-level patterns)

**Do NOT use**: `archive/` documents (historical reference only, ~60% incorrect)

---

## ğŸ”— **Related Documentation**

### **Architecture Decisions**
- [ADR-015: Alert to Signal Naming Migration](../../architecture/decisions/ADR-015-alert-to-signal-naming-migration.md)
- [ADR-016: Validation Responsibility Chain](../../architecture/decisions/ADR-016-validation-responsibility-chain.md)
- [ADR-005: Owner Reference Architecture](../../architecture/decisions/005-owner-reference-architecture.md)

### **Implementation Guides**

### **System Architecture**
- [Approved Microservices Architecture](../../architecture/APPROVED_MICROSERVICES_ARCHITECTURE.md)
- [V1 Source of Truth Hierarchy](../../V1_SOURCE_OF_TRUTH_HIERARCHY.md)

---

## âš™ï¸ **Working with CRDs**

### **Generate CRD Manifests**
```bash
# After modifying api/*/v1alpha1/*_types.go:
make manifests

# This generates:
# - config/crd/bases/*.yaml (CRD manifests)
# - api/*/v1alpha1/zz_generated.deepcopy.go (DeepCopy methods)
```

### **Install CRDs to Cluster**
```bash
make install
```

### **Run Controller Manager Locally**
```bash
make run
```

### **Build Controller Manager Image**
```bash
make docker-build IMG=kubernaut-controller:latest
```

---

## ğŸ“ **Document Maintenance**

**Last Updated**: 2025-01-15
**Archive Created**: 2025-01-15
**Reason**: All 5 design documents were 30-70% incorrect for V1 implementation

**Maintainers**: When updating CRD schemas:
1. Update `api/*/v1alpha1/*_types.go` (source of truth)
2. Run `make manifests` to regenerate YAML
3. Update `docs/architecture/CRD_SCHEMAS.md` if needed
4. Update service specs in `docs/services/crd-controllers/*/crd-schema.md`

**Do NOT update** `archive/` documents - they are historical reference only.

---

## ğŸ“ **Questions?**

- **CRD Schema Questions**: See `docs/architecture/CRD_SCHEMAS.md`
- **Controller Implementation**: See `docs/services/crd-controllers/*/`
- **Architecture Decisions**: See `docs/architecture/decisions/`
- **Triage Details**: See `docs/analysis/CRD_DESIGN_DOCUMENTS_COMPREHENSIVE_TRIAGE.md`

---

**Need to implement a CRD controller?** Start with the service README in `docs/services/crd-controllers/*/README.md` ğŸš€

