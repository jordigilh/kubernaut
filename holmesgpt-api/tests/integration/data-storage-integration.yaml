# Data Storage Service Configuration for Integration Tests
#
# Business Requirement: BR-STORAGE-013 - Semantic Search for Remediation Workflows
# Design Decision: DD-TEST-001 - Port Allocation Strategy
# ADR-030: Service Configuration Management
#
# DD-TEST-001: HolmesGPT-API uses dedicated container names (prefixed with 'hapi')
# to avoid conflicts with Data Storage's own integration tests.
#
# This configuration is used by the Data Storage Service container
# during integration testing.

server:
  port: 8080  # Internal container port
  host: "0.0.0.0"
  readTimeout: "30s"
  writeTimeout: "30s"

logging:
  level: "info"
  format: "json"

database:
  host: "postgres-integration"  # Docker Compose service name (not container name)
  port: 5432  # Internal PostgreSQL port
  name: "kubernaut_test"
  user: "kubernaut"
  # ADR-030 Section 6: Secrets loaded from mounted files
  secretsFile: "/app/secrets/database-credentials.yaml"
  passwordKey: "password"
  sslMode: "disable"
  maxOpenConns: 25
  maxIdleConns: 5
  connMaxLifetime: "5m"
  connMaxIdleTime: "5m"

redis:
  addr: "redis-integration:6379"  # Docker Compose service name
  db: 0
  max_retries: 3
  pool_size: 10
  # ADR-030 Section 6: Secrets loaded from mounted files (empty password for test redis)
  secretsFile: "/app/secrets/redis-credentials.yaml"
  passwordKey: "password"
