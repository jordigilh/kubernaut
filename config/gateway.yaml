# Gateway Service Configuration
# This file is loaded as a ConfigMap in Kubernetes
# Environment variables can override these values (see ADR-030)

server:
  listen_addr: ":8080"
  read_timeout: "30s"
  write_timeout: "30s"
  idle_timeout: "120s"

middleware:
  rate_limit:
    requests_per_minute: 100
    burst: 10

infrastructure:
  redis:
    addr: "redis-gateway:6379"
    db: 0
    password: ""  # Set via GATEWAY_REDIS_PASSWORD environment variable
    dial_timeout: "5s"
    read_timeout: "3s"
    write_timeout: "3s"
    pool_size: 10
    min_idle_conns: 2

processing:
  deduplication:
    ttl: "5m"

  storm:
    rate_threshold: 10        # alerts/minute
    pattern_threshold: 5      # similar alerts
    aggregation_window: "1m"

  environment:
    cache_ttl: "30s"
    configmap_namespace: "kubernaut-system"
    configmap_name: "kubernaut-environment-overrides"

  priority:
    policy_path: "/etc/gateway/policies/priority.rego"

