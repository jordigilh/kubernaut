apiVersion: v1
kind: ConfigMap
metadata:
  name: context-api-config
  namespace: kubernaut-system
  labels:
    app: context-api
    component: configuration
    part-of: kubernaut
data:
  config.yaml: |
    server:
      port: 8091
      host: "0.0.0.0"
      readTimeout: "30s"
      writeTimeout: "30s"

    logging:
      level: "info"
      format: "json"

    cache:
      redis_addr: "redis.kubernaut-system.svc.cluster.local:6379"
      redis_db: 0
      lru_size: 1000
      default_ttl: "5m"

    database:
      host: "postgres.kubernaut-system.svc.cluster.local"
      port: 5432
      name: "action_history"
      user: "slm_user"
      # Password provided via Secret environment variable
      sslMode: "disable"

---
apiVersion: v1
kind: Secret
metadata:
  name: context-api-db-secret
  namespace: kubernaut-system
  labels:
    app: context-api
    component: secrets
    part-of: kubernaut
type: Opaque
stringData:
  password: "slm_password_dev"
  # NOTE: This must match the password in postgres-secret
  # For production: Use secure password management (Sealed Secrets, Vault, etc.)

