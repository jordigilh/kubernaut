# Kubernaut Workflow Schema v1.0
# Authority: ADR-043
# See: docs/architecture/decisions/ADR-043-workflow-schema-definition-standard.md
#
# Test Intentional Failure Workflow - E2E Testing
# This workflow validates failure handling in the WorkflowExecution controller

apiVersion: kubernaut.io/v1alpha1
kind: WorkflowSchema

# ============================================
# METADATA (Required)
# ============================================
metadata:
  workflow_id: test-intentional-failure
  version: "v1.0.0"
  name: "Test Intentional Failure Workflow"
  description: "Intentionally failing workflow for E2E testing of WorkflowExecution failure handling"

# ============================================
# LABELS (Required - 6 mandatory + optional)
# DD-WORKFLOW-001 v1.3
# ============================================
labels:
  # Mandatory labels (all 6 required)
  kubernaut.ai/signal-type: "test"
  kubernaut.ai/severity: "low"
  kubernaut.ai/category: "testing"
  kubernaut.ai/resource-kind: "deployment"
  kubernaut.ai/intervention-type: "non-invasive"
  kubernaut.ai/workflow-type: "test"

  # Optional custom labels
  kubernaut.ai/test-category: "e2e"
  kubernaut.ai/validation-type: "failure-path"

# ============================================
# EXECUTION (Optional in V1.0)
# ============================================
execution:
  engine: "tekton"
  # bundle: derived from OCI bundle

# ============================================
# PARAMETERS (Required)
# ============================================
parameters:
  - name: "TARGET_RESOURCE"
    type: "string"
    required: true
    description: "Target resource (test purposes only)"
    default: "test/deployment/failing"

  - name: "FAILURE_MODE"
    type: "string"
    required: false
    description: "How to fail: 'exit' (non-zero exit), 'timeout', 'oom' (simulated)"
    default: "exit"
    enum: ["exit", "timeout", "oom"]

  - name: "FAILURE_MESSAGE"
    type: "string"
    required: false
    description: "Error message to include in failure output"
    default: "Intentional test failure"

# ============================================
# ROLLBACK PARAMETERS (Optional)
# ============================================
# Not applicable for test workflow

