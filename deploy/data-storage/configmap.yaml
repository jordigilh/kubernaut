apiVersion: v1
kind: ConfigMap
metadata:
  name: data-storage-config
  namespace: kubernaut-system
data:
  config.yaml: |
    server:
      port: 8080
      host: "0.0.0.0"
      read_timeout: "30s"
      write_timeout: "30s"
    
    logging:
      level: "info"
      format: "json"
    
    database:
      host: "postgresql.kubernaut-system.svc.cluster.local"
      port: 5432
      name: "action_history"
      user: "db_user"
      sslMode: "disable"
      maxOpenConns: 50
      maxIdleConns: 25
      connMaxLifetime: "15m"
      connMaxIdleTime: "10m"
      secretsFile: "/etc/datastorage/secrets/db-secrets.yaml"
      usernameKey: "username"
      passwordKey: "password"
    
    redis:
      addr: "redis.kubernaut-system.svc.cluster.local:6379"
      db: 0
      dlqStreamName: "audit:dlq:production"
      dlqMaxLen: 10000
      dlqConsumerGroup: "datastorage-dlq-consumers"
      secretsFile: "/etc/datastorage/secrets/redis-secrets.yaml"
      passwordKey: "password"

