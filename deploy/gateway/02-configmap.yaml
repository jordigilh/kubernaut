apiVersion: v1
kind: ConfigMap
metadata:
  name: gateway-config
  namespace: kubernaut-gateway
  labels:
    app.kubernetes.io/name: kubernaut
    app.kubernetes.io/component: gateway
    app.kubernetes.io/part-of: kubernaut
data:
  config.yaml: |
    # Gateway Service Configuration
    # Organized by Single Responsibility Principle
    # See: pkg/gateway/server.go - type ServerConfig struct

    # HTTP Server configuration
    server:
      listen_addr: ":8080"
      read_timeout: 30s
      write_timeout: 30s
      idle_timeout: 120s

    # Middleware configuration
    middleware:
      rate_limit:
        requests_per_minute: 100
        burst: 10

    # Infrastructure dependencies
    infrastructure:
      redis:
        addr: redis-gateway.kubernaut-gateway.svc.cluster.local:6379
        db: 0
        dial_timeout: 5s
        read_timeout: 3s
        write_timeout: 3s
        pool_size: 10
        min_idle_conns: 2

    # Business logic configuration
    processing:
      deduplication:
        ttl: 5m

      storm:
        rate_threshold: 10
        pattern_threshold: 5
        aggregation_window: 1m

      environment:
        cache_ttl: 30s
        configmap_namespace: kubernaut-system
        configmap_name: kubernaut-environment-overrides

