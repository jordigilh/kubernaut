# CrashLoop Config Fix Workflow Schema - Job Backend (BR-WORKFLOW-004)
# Used by: FullPipeline E2E (execution.engine: job)
metadata:
  workflowId: crashloop-config-fix-v1
  version: "1.0.0"
  description:
    what: "Restarts deployment to recover from CrashLoopBackOff caused by configuration issues"
    whenToUse: "When pods are in CrashLoopBackOff due to misconfiguration"
    whenNotToUse: "When crash is caused by a persistent code bug"
    preconditions: "Pod is managed by a Deployment"

actionType: RestartDeployment

labels:
  signalName: CrashLoopBackOff
  severity: [high, medium]
  environment: [production, staging, test]
  component: "*"
  priority: "*"

execution:
  engine: job
  bundle: quay.io/kubernaut-cicd/test-workflows/crashloop-config-fix-job:v1.0.0-exec@sha256:c72912b0e5c5b2a4da1b11df150480aaeb3267ddd96119bcb913d91ce7440ea7

parameters:
  - name: NAMESPACE
    type: string
    required: true
    description: "Target namespace"
  - name: DEPLOYMENT_NAME
    type: string
    required: true
    description: "Name of the deployment to restart"
  - name: GRACE_PERIOD_SECONDS
    type: integer
    required: false
    description: "Graceful shutdown period in seconds"
    default: 30
    minimum: 0
    maximum: 300
